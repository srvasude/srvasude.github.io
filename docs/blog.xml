<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Shores of Infinity</title>
<link>https://www.shoresofinfinity.net/blog.html</link>
<atom:link href="https://www.shoresofinfinity.net/blog.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.8.24</generator>
<lastBuildDate>Tue, 07 Oct 2025 07:00:00 GMT</lastBuildDate>
<item>
  <title>Counting the number of abelian groups</title>
  <dc:creator>Srinivas Vasudevan</dc:creator>
  <link>https://www.shoresofinfinity.net/posts/counting_abelian_groups/counting_abelian_groups.html</link>
  <description><![CDATA[ 




<p>As an undergraduate, I got exposed to group theory and notably the classification of finite abelian groups <sup>1</sup>. I have recently thought about how to count asymptotically the number of these groups up to isomorphism. It turns out this problem was originally solved by Erdos and Szekeres<sup>2</sup>, and we’’ll try to summarize their argument here.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;And more generally the classification of finitely generated abelian groups.</p></div><div id="fn2"><p><sup>2</sup>&nbsp;See <a href="https://www.renyi.hu/~p_erdos/1934-05.pdf">here</a> for their solution.</p></div></div><section id="review-whirlwind-group-theory" class="level2">
<h2 class="anchored" data-anchor-id="review-whirlwind-group-theory">Review: Whirlwind Group Theory</h2>
<p>First, recall a group <img src="https://latex.codecogs.com/png.latex?G"> is a set equipped with an operation <img src="https://latex.codecogs.com/png.latex?*">, satisfying the following axioms:</p>
<ol type="1">
<li>Closure: <img src="https://latex.codecogs.com/png.latex?a%20*%20b%20%5Cin%20G,%5C,%20%5Cforall%20a,%20b%20%5Cin%20G"></li>
<li>Associativity: <img src="https://latex.codecogs.com/png.latex?(a%20*%20b)%20*%20c%20=%20a%20*%20(b%20*%20c),%5C,%20%5Cforall%20a,%20b,%20c%20%5Cin%20G"></li>
<li>Identity: <img src="https://latex.codecogs.com/png.latex?%5Cexists%20e%20%5Cin%20G,%5C,%20%5Ctext%7Bs.t.%7D%5C,%20%5Cforall%20a%20%5Cin%20G,%5C,%20e%20*%20a%20=%20a%20*%20e%20=%20a"></li>
<li>Inverse: <img src="https://latex.codecogs.com/png.latex?%5Cforall%20a%20%5Cin%20G,%5C,%20%5Cexists%20a%5E%7B-1%7D%20%5Cin%20G,%5C,%20%5Ctext%7Bs.t.%7D%20%5C,a%5E%7B-1%7D%20*%20a%20=%20a%20*%20a%5E%7B-1%7D%20=%20e"></li>
</ol>
<p>A commutative group satisfies the following additional axiom</p>
<ol start="5" type="1">
<li>Commutativity: <img src="https://latex.codecogs.com/png.latex?a%20*%20b%20=%20b%20*%20a,%5C,%20%5Cforall%20a,%20b%20%5Cin%20G">.</li>
</ol>
<p>Since a group is a set <img src="https://latex.codecogs.com/png.latex?G">, we can look at the cardinality of the set <img src="https://latex.codecogs.com/png.latex?%7CG%7C">. A finite group is one where <img src="https://latex.codecogs.com/png.latex?%7CG%7C%20%3C%20%5Cinfty"> and the order of a group is simply this number <img src="https://latex.codecogs.com/png.latex?ord(G)%20=%20%7CG%7C">.</p>
<p>What we are interested in is how many finite abelian groups up to <em>isomorphism</em> have order <img src="https://latex.codecogs.com/png.latex?n">. We’ll call this <img src="https://latex.codecogs.com/png.latex?a(n)">. Figure&nbsp;1 plots <img src="https://latex.codecogs.com/png.latex?a(n)"> for orders 1 to 10000.</p>
<p>We can see that the number varies a lot, and unclear if it even grows. In particular if <img src="https://latex.codecogs.com/png.latex?ord(G)%20=%20p"> for a prime <img src="https://latex.codecogs.com/png.latex?p">, there is only one group of that order, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D"> the cyclic group of order <img src="https://latex.codecogs.com/png.latex?p">. That is, <img src="https://latex.codecogs.com/png.latex?a(p)%20=%201"> for all primes <img src="https://latex.codecogs.com/png.latex?p">, so it dips to 1 infinitely often.</p>
<p>What we might care about instead is a smoothed version of this <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bx%7D%5Csum_%7Bn%20%5Cle%20x%7D%20a(n)">, which represents the average value of <img src="https://latex.codecogs.com/png.latex?a(n)">. Figure&nbsp;1 shows that this seems to be grow but asymptote around a little over <img src="https://latex.codecogs.com/png.latex?2">. In fact as proven by Erdos and Szekeres we’ll have</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bn%20%5Cle%20x%7D%20a(n)%20%5Csim%20%5Cprod_%7Bk=2%7D%5E%5Cinfty%20%5Czeta(k)%20x"></p>
<p>Where <img src="https://latex.codecogs.com/png.latex?%5Czeta"> is the Riemann Zeta function. This constant in front is roughly <img src="https://latex.codecogs.com/png.latex?2.29">, and is represented by the blue line in the plot.</p>
<div id="cell-fig-abelian-groups-n" class="cell" data-fig-height="1" data-fig-width="1" data-layout-ncols="2" data-message="false" data-execution_count="1">
<div class="cell-output cell-output-display">
<div id="fig-abelian-groups-n" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-abelian-groups-n-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="counting_abelian_groups_files/figure-html/fig-abelian-groups-n-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Number of abelian groups of order N."><img src="https://www.shoresofinfinity.net/posts/counting_abelian_groups/counting_abelian_groups_files/figure-html/fig-abelian-groups-n-output-1.png" width="731" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-abelian-groups-n-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Number of abelian groups of order N.
</figcaption>
</figure>
</div>
</div>
<p>Number of Abelian Groups of order N</p>
</div>
</section>
<section id="structure-of-an." class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="structure-of-an.">Structure of <img src="https://latex.codecogs.com/png.latex?a(n)">.</h2>
<p>The fundamental theorem of finite abelian groups says that every finite abelian group can be written in the form <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p_1%5E%7Bk_1%7D%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p_2%5E%7Bk_2%7D%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p_3%5E%7Bk_3%7D%5Cmathbb%7BZ%7D%20%5Cldots%20%5Cmathbb%7BZ%7D/p_n%5E%7Bk_n%7D%5Cmathbb%7BZ%7D"> where <img src="https://latex.codecogs.com/png.latex?p_i"> are primes, not necessarily distinct, and <img src="https://latex.codecogs.com/png.latex?k_i%20%5Cin%20%5Cmathbb%7BN%7D">. <sup>3</sup></p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;In fact each <img src="https://latex.codecogs.com/png.latex?p_i"> must appear in the prime factorization of <img src="https://latex.codecogs.com/png.latex?ord(G)">.</p></div></div><p>Recall that a finite <img src="https://latex.codecogs.com/png.latex?p">-group is which has prime power order <img src="https://latex.codecogs.com/png.latex?ord(G)%20=%20p%5Ek"> for some prime <img src="https://latex.codecogs.com/png.latex?p">, and natural number <img src="https://latex.codecogs.com/png.latex?k">.</p>
<p>We can group the factors into <img src="https://latex.codecogs.com/png.latex?P_1,%20%5Cldots%20P_m">, where <img src="https://latex.codecogs.com/png.latex?P_i"> is a product of factors containing the same prime. That is, every finite abelian group can be written as <img src="https://latex.codecogs.com/png.latex?P_1%20%5Ctimes%20P_2%20%5Ctimes%20%5Cldots%20P_m">, where <img src="https://latex.codecogs.com/png.latex?P_i"> are abelian <img src="https://latex.codecogs.com/png.latex?q_i">-groups, with the <img src="https://latex.codecogs.com/png.latex?q_i"> distinct. The order of such a group <img src="https://latex.codecogs.com/png.latex?G"> is <img src="https://latex.codecogs.com/png.latex?ord(G)%20=%20ord(P_1)ord(P_2)%5Cldots%20ord(P_m)">.</p>
<p>This is suggestive that if we are looking at <img src="https://latex.codecogs.com/png.latex?a(n)">, we should look at the prime factorization of <img src="https://latex.codecogs.com/png.latex?n%20=%20p_1%5E%7Bk_1%7Dp_2%5E%7Bk_2%7D%5Cldots%20p_m%5E%7Bk_m%7D">. For any abelian group of order <img src="https://latex.codecogs.com/png.latex?n"> it will have factors <img src="https://latex.codecogs.com/png.latex?P_1%20%5Ctimes%20P_2%20%5Cldots%20%5Ctimes%20P_m">, where <img src="https://latex.codecogs.com/png.latex?P_i"> is a <img src="https://latex.codecogs.com/png.latex?p_i">-group of order <img src="https://latex.codecogs.com/png.latex?p_i%5E%7Bk_i%7D">. Then, we will have <img src="https://latex.codecogs.com/png.latex?a(n)%20=%20a(p_1%5E%7Bk_1%7D)a(p_2%5E%7Bk_2%7D)%5Cldots%20a(p_m%5E%7Bk_m%7D)">. In other words <img src="https://latex.codecogs.com/png.latex?a(n)"> is a multiplicative function!</p>
<section id="apk" class="level3">
<h3 class="anchored" data-anchor-id="apk"><img src="https://latex.codecogs.com/png.latex?a(p%5Ek)"></h3>
<p>Now, given a prime <img src="https://latex.codecogs.com/png.latex?p">, we want to count the number of abelian groups of order <img src="https://latex.codecogs.com/png.latex?p%5Ek">, for some <img src="https://latex.codecogs.com/png.latex?k%20%5Cin%20%5Cmathbb%7BN%7D">. We can enumerate a few cases to see a pattern.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?k%20=%201">, we have only one group, since <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D"> is simple. <img src="https://latex.codecogs.com/png.latex?a(p)%20=%201"></p>
<p>For <img src="https://latex.codecogs.com/png.latex?k%20=%202"> we have two groups: <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5E2%5Cmathbb%7BZ%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D%20/%20p%5Cmathbb%7BZ%7D">. <img src="https://latex.codecogs.com/png.latex?a(p%5E2)%20=%202"></p>
<p>For <img src="https://latex.codecogs.com/png.latex?k%20=%203"> we have three groups: <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5E3%5Cmathbb%7BZ%7D">, <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5E2%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D"> and <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D">. <img src="https://latex.codecogs.com/png.latex?a(p%5E3)%20=%203"></p>
<p>What we’ve done above is take <img src="https://latex.codecogs.com/png.latex?p%5Ek"> and look at ways to partition <img src="https://latex.codecogs.com/png.latex?k">.</p>
<p>For instance, the 11 partitions of <img src="https://latex.codecogs.com/png.latex?6"> are:</p>
<p>1 + 1 + 1 + 1 + 1 + 1</p>
<p>2 + 1 + 1 + 1 + 1</p>
<p>2 + 2 + 1 + 1</p>
<p>3 + 1 + 1 + 1</p>
<p>2 + 2 + 2</p>
<p>3 + 2 + 1</p>
<p>4 + 1 + 1</p>
<p>3 + 3</p>
<p>4 + 2</p>
<p>5 + 1</p>
<p>6</p>
<p>We can then arrange factors based of that partition. If we take <img src="https://latex.codecogs.com/png.latex?%5B3,%202,%201%5D">, then we have <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BZ%7D/p%5E3%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p%5E2%5Cmathbb%7BZ%7D%20%5Ctimes%20%5Cmathbb%7BZ%7D/p%5Cmathbb%7BZ%7D">.</p>
<p>Likewise, given any factorization of the <img src="https://latex.codecogs.com/png.latex?p">-group, we can order the factors in descending order and show that forms a partition of <img src="https://latex.codecogs.com/png.latex?6">. Thus, <img src="https://latex.codecogs.com/png.latex?a(p%5E6)%20=%2011">, and more generally <img src="https://latex.codecogs.com/png.latex?a(p%5Ek)%20=%20p(k)"> where <img src="https://latex.codecogs.com/png.latex?p(k)"> is the number of partitions of <img src="https://latex.codecogs.com/png.latex?k">.</p>
</section>
</section>
<section id="dirichlet-generating-function" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="dirichlet-generating-function">Dirichlet Generating Function</h2>
<p>Given that <img src="https://latex.codecogs.com/png.latex?a(n)"> is a multiplicative function, it’s suggestive to look at <img src="https://latex.codecogs.com/png.latex?f(s)%20=%20%5Csum_%7Bi=1%7D%5E%5Cinfty%20%5Cfrac%7Ba(n)%7D%7Bn%5Es%7D">, at least formally. Since <img src="https://latex.codecogs.com/png.latex?a(n)"> is multiplicative, it has an Euler product expansion <img src="https://latex.codecogs.com/png.latex?f(s)%20=%20%5Cprod_p%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cfrac%7Ba(p%5Ek)%7D%7Bp%5E%7Bsk%7D%7D%20=%20%5Cprod_p%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cfrac%7Bp(k)%7D%7Bp%5E%7Bsk%7D%7D">. It can be shown that the products converge for <img src="https://latex.codecogs.com/png.latex?%5CRe(s)%20%3E%201">, due to the asymptotics of partition numbers <img src="https://latex.codecogs.com/png.latex?p(k)"> (which we will skip here).</p>
<p>Now each inner sum is of the form <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cfrac%7Ba(p%5Ek)%7D%7Bp%5E%7Bsk%7D%7D%20=%20%5Csum_%7Bk=0%7D%5E%5Cinfty%20%5Cfrac%7Bp(k)%7D%7Bp%5E%7Bsk%7D%7D">. Let <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Cfrac%7B1%7D%7Bp%7D">. Then we have the sum <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bk=0%7D%5E%5Cinfty%20p(k)x%5E%7Bsk%7D">.</p>
<p>This is the ordinary generating function for the partition function, which also can be written as <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Cfrac%7B1%7D%7B1%20-%20x%5E%7Bsk%7D%7D">. This is valid since <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bp%7D%20%3C%201">.</p>
<p>Thus we can rewrite <img src="https://latex.codecogs.com/png.latex?f(n)%20=%20%5Cprod_p%20%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Cfrac%7B1%7D%7B1%20-%20(%5Cfrac%7B1%7D%7Bp%7D)%5E%7Bsk%7D%7D">. Applying the Fubini-Tonelli theorem<sup>4</sup> lets us rearrange the product to get <img src="https://latex.codecogs.com/png.latex?%5Cprod_p%20%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Cfrac%7B1%7D%7B1%20-%20(%5Cfrac%7B1%7D%7Bp%7D)%5E%7Bsk%7D%7D%20=%20%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Cprod_p%20%5Cfrac%7B1%7D%7B1%20-%20(%5Cfrac%7B1%7D%7Bp%7D)%5E%7Bsk%7D%7D%20=%20%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Czeta(ks)">.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;See <a href="https://en.wikipedia.org/wiki/Fubini%27s_theorem">here</a> for a summary. In general, this will let us change the order of summation / multiplication.</p></div><div id="fn5"><p><sup>5</sup>&nbsp;We omit the proof of this here, but roughly the terms <img src="https://latex.codecogs.com/png.latex?%5Czeta(ks)%20%5Crightarrow%201"> as <img src="https://latex.codecogs.com/png.latex?k%20%5Crightarrow%20%5Cinfty">, and in fact this convergence is geometric in nature. We can then show that if we ignore the first few terms, in the strip <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7Bn+1%7D%20%3C%20%5CRe(s)%20%3C%20%5Cfrac%7B1%7D%7Bn%7D">, the product converges, and will gives us a meromorphic continuation of the function.</p></div></div><p>Thus the Dirichlet generating function for <img src="https://latex.codecogs.com/png.latex?a(n)"> is <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Czeta(ks)">, which converges when <img src="https://latex.codecogs.com/png.latex?%5CRe(s)%20%3E%201">. In fact we can meromorphically expand this to <img src="https://latex.codecogs.com/png.latex?%5CRe(s)%20%3E%200">, by noting that there are poles at <img src="https://latex.codecogs.com/png.latex?1,%20%5Cfrac%7B1%7D%7B2%7D,%20%5Cfrac%7B1%7D%7B3%7D%20%5Cldots%20%5Cfrac%7B1%7D%7Bn%7D%20%5Cldots">, but the product still converges outside of those areas. <sup>5</sup></p>
</section>
<section id="counting-the-number-of-abelian-groups" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="counting-the-number-of-abelian-groups">Counting the number of abelian groups</h2>
<p>We’ve buried the lede so far on how we are going to estimate <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bn%5Cle%20x%7D%20a(n)">. In particular, Perron’s Formula says that if <img src="https://latex.codecogs.com/png.latex?f(s)"> is the Dirichlet generating function for <img src="https://latex.codecogs.com/png.latex?a(n)">, then we have that if <img src="https://latex.codecogs.com/png.latex?f(s)"> is uniformly convergent for <img src="https://latex.codecogs.com/png.latex?%5CRe(s)%20%3E%20%5Csigma"> for some fixed <img src="https://latex.codecogs.com/png.latex?%5Csigma">, and <img src="https://latex.codecogs.com/png.latex?c%20%3E%20%5Csigma">, then<sup>6</sup></p>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;For <img src="https://latex.codecogs.com/png.latex?x"> an integer, we need to modify the sum so that the last term <img src="https://latex.codecogs.com/png.latex?a(x)"> is multiplied by <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D">. Otherwise the left-hand side is an ordinary sum.</p></div></div><p><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bn%5Cle%20x%7D%20a(n)%20+%20O(%5Csum_%7Bn=1%7D%5E%5Cinfty(%5Cfrac%7Bx%7D%7Bn%7D)%5Ec%20%5Cfrac%7Ba(n)%7D%7BT%7C%5Clog%20%5Cfrac%7Bx%7D%7Bn%7D%7C%7D)%20=%20%5Cfrac%7B1%7D%7B2%5Cpi%20i%7D%20%5Cint_%7Bc-iT%7D%5E%7Bc+iT%7D%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7Dds"></p>
<p>That is, if we we compute the line integral of the function <img src="https://latex.codecogs.com/png.latex?A(s)%20=%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7D"> over the truncated line <img src="https://latex.codecogs.com/png.latex?%5CRe(s)%20=%20c">, that should give us what we want plus an error term. Figure&nbsp;2 shows the contour for <img src="https://latex.codecogs.com/png.latex?%5CRe(s)%20=%202">.</p>
<div id="cell-fig-contour" class="cell page-columns page-full" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="2">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-contour" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="counting_abelian_groups_files/figure-html/fig-contour-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Contour for Perron’s Formula"><img src="https://www.shoresofinfinity.net/posts/counting_abelian_groups/counting_abelian_groups_files/figure-html/fig-contour-output-1.png" width="304" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Contour for Perron’s Formula
</figcaption>
</figure>
</div>
</div></div></div>
<p>Let’s bound the error term.</p>
<p>When <img src="https://latex.codecogs.com/png.latex?n%20%3C%200.9x"> or <img src="https://latex.codecogs.com/png.latex?n%20%3E%201.1x"> we have that</p>
<p><img src="https://latex.codecogs.com/png.latex?O(%5Csum%20(%5Cfrac%7Bx%7D%7Bn%7D)%5Ec%20%5Cfrac%7Ba(n)%7D%7BT%7C%5Clog%20%5Cfrac%7Bx%7D%7Bn%7D%7C%7D)%20=%20O(%5Cfrac%7Bx%5Ec%7D%7BT%7D%5Csum%20%5Cfrac%7Ba(n)%7D%7Bn%5Ec%7D)%20=%20O(%5Cfrac%7Bx%5Ec%5Cprod_%7Bk=1%7D%5E%5Cinfty%20%5Czeta(kc)%7D%7BT%7D)%20=%20O(%5Cfrac%7Bx%5Clog%20x%7D%7BT%7D)">.</p>
<p>The latter equality is a combination of three steps. We first fix <img src="https://latex.codecogs.com/png.latex?c%20=%201%20+%20%5Cfrac%7B1%7D%7B%5Clog%20x%7D"> which gives us the linear power in <img src="https://latex.codecogs.com/png.latex?x">. Also, noting that <img src="https://latex.codecogs.com/png.latex?%5Cprod_%7Bk=2%7D%5E%5Cinfty%20%5Czeta(kc)"> is bounded, we only need to consider the <img src="https://latex.codecogs.com/png.latex?%5Czeta(c)"> term. As <img src="https://latex.codecogs.com/png.latex?%5Czeta(c)%20=%20O(%5Cfrac%7B1%7D%7B%7Cc%20-%201%7C%7D)">, for <img src="https://latex.codecogs.com/png.latex?c"> approaching 1, the rest follows.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?0.9x%20%5Cle%20n%20%5Cle%201.1x">, <img src="https://latex.codecogs.com/png.latex?O(%5Csum_%7B0.9x%20%5Cle%20n%20%5Cle%201.1x%7D%20(%5Cfrac%7Bx%7D%7Bn%7D)%5Ec%20%5Cfrac%7Ba(n)%7D%7BT%7C%5Clog%20%5Cfrac%7Bx%7D%7Bn%7D%7C%7D)%20=%20O(%5Csum_%7B0.9x%20%5Cle%20n%20%5Cle%201.1x%7D%20%5Cfrac%7Ba(n)%7D%7BT%7C%5Clog%20%5Cfrac%7Bx%7D%7Bn%7D%7C%7D)">.</p>
<p>We’ll assume now that <img src="https://latex.codecogs.com/png.latex?x%20=%20%5Clfloor%20x%20%5Crfloor%20+%20%5Cfrac%7B1%7D%7B2%7D">. That is, <img src="https://latex.codecogs.com/png.latex?x"> is a half integer. Then, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B%7C%5Clog%20%5Cfrac%7Bx%7D%7Bn%7D%7C%7D%20=%20O(%7C%5Cfrac%7Bx%7D%7Bn%20-%20x%20-%20%5Cfrac%7B1%7D%7B2%7D%7D%7C)">, since <img src="https://latex.codecogs.com/png.latex?n"> is close to <img src="https://latex.codecogs.com/png.latex?x">.</p>
<p>If <img src="https://latex.codecogs.com/png.latex?k%20=%20n%20-%20x">, we have our error bounded by <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7Bx%7D%7BT%7D%5Csum_%7B%7Ck%7C%20%5Cle%200.1%20x%7D%20%5Cfrac%7B1%7D%7B%7Ck%20-%20%5Cfrac%7B1%7D%7B2%7D%7C%7D)%20=%20O(%5Cfrac%7Bx%5Clog%20x%7D%7BT%7D)"> <sup>7</sup></p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;The latter inequality comes from the fact that the Harmonic numbers grow like <img src="https://latex.codecogs.com/png.latex?%5Clog%20x">.</p></div></div><section id="modified-integral" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="modified-integral">Modified Integral</h3>
<p>We’ll modify the main integral by relating it to a shifted integral on the left hand size of the pole at 1.</p>
<p>Let <img src="https://latex.codecogs.com/png.latex?c%20=%201%20+%20%5Cfrac%7B1%7D%7B%5Clog%20x%7D,%20%5Cfrac%7B1%7D%7B2%7D%20%3C%20%5Cdelta%20%3C%201">. Let <img src="https://latex.codecogs.com/png.latex?A%20=%20%5Cprod_%7Bk=2%7D%5E%5Cinfty%20%5Czeta(k)">, and consider the contour in Figure&nbsp;3, where we are integrating over it in the counterclockwise direction.</p>
<div id="cell-fig-contour-modified" class="cell page-columns page-full" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="3">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-contour-modified" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-contour-modified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="counting_abelian_groups_files/figure-html/fig-contour-modified-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Modified Contour"><img src="https://www.shoresofinfinity.net/posts/counting_abelian_groups/counting_abelian_groups_files/figure-html/fig-contour-modified-output-1.png" width="299" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-contour-modified-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Modified Contour
</figcaption>
</figure>
</div>
</div></div></div>
<p>This contour <img src="https://latex.codecogs.com/png.latex?B"> is now a box around the pole <img src="https://latex.codecogs.com/png.latex?1">. <img src="https://latex.codecogs.com/png.latex?C_1"> corresponds to our original contour (of length <img src="https://latex.codecogs.com/png.latex?2T">) while <img src="https://latex.codecogs.com/png.latex?C_3">, is a shifted version.</p>
<p>We have the sides of the box parameterized as:</p>
<p><img src="https://latex.codecogs.com/png.latex?C_1%20=%20%5C%7Bs%20%7C%20%5CRe(s)%20=%20c,%20-T%20%5Cle%20%5CIm(s)%20%5Cle%20T%5C%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?C_2%20=%20%5C%7Bs%20%7C%20%5CIm(s)%20=%20-T,%20%5Cdelta%20%5Cle%20%5CRe(s)%20%5Cle%20c%5C%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?C_3%20=%20%5C%7Bs%20%7C%20%5CRe(s)%20=%20%5Cdelta,%20-T%20%5Cle%20%5CIm(s)%20%5Cle%20T%5C%7D"></p>
<p><img src="https://latex.codecogs.com/png.latex?C_4%20=%20%5C%7Bs%20%7C%20%5CIm(s)%20=%20T,%20%5Cdelta%20%5Cle%20%5CRe(s)%20%5Cle%20c%5C%7D"></p>
<p>Since <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20%3E%20%5Cfrac%7B1%7D%7B2%7D">, the box does not have any poles on its path, and only contains one pole inside. We have by the residue theorem, the value of this new contour is <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%5Cpi%20i%7D%5Cint_B%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7D%20ds%20=%20Res_%7Bs=1%7D%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7D%20=%20%5Cprod_%7Bk=2%7D%5E%5Cinfty%20%5Czeta(k)%20x%20=%20Ax"></p>
<p>Thus, breaking apart <img src="https://latex.codecogs.com/png.latex?B"> into its constituent integrals, we get that <img src="https://latex.codecogs.com/png.latex?Ax%20=%20%5Csum_%7Bn%5Cle%20x%7Da(n)%20+%20O(%5Cfrac%7Bx%5Clog%20x%7D%7BT%7D)%20+%20%5Cint_%7BC_2%20%5Ccup%20C_3%20%5Ccup%20C_4%7D%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7D%20ds">.</p>
<p>We will now bound the contours <img src="https://latex.codecogs.com/png.latex?C_2,%20C_3,%20C_4">.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?C_2">, we can bound <img src="https://latex.codecogs.com/png.latex?%7Cf(s)%7C"> by <img src="https://latex.codecogs.com/png.latex?B%7C%5Czeta(s)%7C"> where <img src="https://latex.codecogs.com/png.latex?B%20=%20%5Cprod_%7Bk=2%7D%5E%5Cinfty%20%5Czeta(k%5Cdelta)">. This is due to the monotonicity of <img src="https://latex.codecogs.com/png.latex?%5Czeta(s)"> for <img src="https://latex.codecogs.com/png.latex?s%20%3E%201">, and that since <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20%3E%20%5Cfrac%7B1%7D%7B2%7D">, <img src="https://latex.codecogs.com/png.latex?k%5Cdelta%20%3E%201,%20%5C,%20%5Cforall%20k%20%5Cge%202">.</p>
<p>It is also known that <img src="https://latex.codecogs.com/png.latex?%7C%5Czeta(s)%7C%20=%20O((1%20+%20%7C%5CIm(s)%7C)%5E%7B1%20-%20%5CRe(s)%7D%5Clog(1%20+%20%5CIm(s))">, for <img src="https://latex.codecogs.com/png.latex?%5CIm(s)%20%3E%202,%20%5CRe(s)%20%3E%200">.</p>
<p>Thus, for <img src="https://latex.codecogs.com/png.latex?C_2"> we have the bound <img src="https://latex.codecogs.com/png.latex?%7C%5Cint_%7BC_2%7D%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7D%20ds%7C%20=%20O(%5Cint_%5Cdelta%5Ec%20%7C%5Czeta(s%20+%20iT)%7C%7C%5Cfrac%7Bx%5E%7Bs%20+%20iT%7D%7D%7Bs%20+%20iT%7D%7C%20ds)%20=%20O(%5Cint_%5Cdelta%5Ec%20%5Cfrac%7Bx%5Es(1%20+%20T)%5E%7B1%20-%20s%7D%20%5Clog%20T%7D%7BT%7D%20%20ds)%20=%20O(%5Cfrac%7Bx%5Clog%20x%7D%7BT%7D%20+%20%5Cfrac%7Bx%5E%5Cdelta%20T%5E%7B1-%5Cdelta%7D%5Clog%20T%7D%7BT%7D)"> This same bound holds for <img src="https://latex.codecogs.com/png.latex?C_4"> by a similar argument.</p>
<p>For <img src="https://latex.codecogs.com/png.latex?C_3"> we have <img src="https://latex.codecogs.com/png.latex?%7C%5Cint_%7BC_3%7D%20f(s)%5Cfrac%7Bx%5Es%7D%7Bs%7D%20ds%7C%20=%20O(%5Cint_%7B-T%7D%5ET%7C%5Czeta(%5Cdelta%20+%20iT)%5Cfrac%7Bx%5E%7B%5Cdelta%7D%7D%7B%5Cdelta%20+%20it%7D%7C%20dt)%20=%20O(%5Cint_%7B-T%7D%5ET(1%20+%20%7Ct%7C)%5E%7B1%20-%20%5Cdelta%7D%5Cfrac%7Bx%5E%5Cdelta%7D%7B1%20+%20%7Ct%7C%7D%5Clog%20T%20dt)%20=%20O(x%5E%5Cdelta%20T%5E%7B1%20-%20%5Cdelta%7D%5Clog%20T)"></p>
<p>Thus we have <img src="https://latex.codecogs.com/png.latex?Ax%20=%20%5Csum_%7Bn%20%5Cle%20x%7D%20a(n)%20+%20O(%5Cfrac%7Bx%5Clog%20x%7D%7BT%7D)%20+%20O(%5Cfrac%7Bx%5Clog%20x%7D%7BT%7D%20+%20%5Cfrac%7Bx%5E%5Cdelta%20T%5E%7B1-%5Cdelta%7D%5Clog%20T%7D%7BT%7D)%20+%20O(x%5E%5Cdelta%20T%5E%7B1%20-%20%5Cdelta%7D%5Clog%20T)"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?%5Cdelta%20=%20%5Cfrac%7B1%7D%7B2%7D%20+%20%5Cepsilon">, for <img src="https://latex.codecogs.com/png.latex?%5Cepsilon%20%3E%200">. Let <img src="https://latex.codecogs.com/png.latex?T%20=%20%5Csqrt%7Bx%7D">. Then we have the errors are of the form</p>
<p><img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%7Bx%7D%5Clog%20x)%20+%20O(%5Csqrt%7Bx%7D%20%5Clog%20x%20+%20x%5E%7B%5Cfrac%7B1%7D%7B4%7D%20-%20%5Cepsilon%7D%5Clog%20x)%20+%20O(x%5E%7B%5Cfrac%7B1%7D%7B2%7D%20+%20%5Cepsilon%7D%20x%5E%7B%5Cfrac%7B1%7D%7B4%7D%20-%20%5Cfrac%7B%5Cepsilon%7D%7B2%7D%7D%5Clog%20x)%20=%20O(x%5E%7B%5Cfrac%7B3%7D%7B4%7D%20+%20%5Cepsilon%7D)">.</p>
<p>The error is sublinear, and we are done.</p>
<p>More careful treatment can reduce this error down to <img src="https://latex.codecogs.com/png.latex?O(%5Csqrt%7Bx%7D)">. In fact<sup>8</sup> we have</p>
<div class="no-row-height column-margin column-container"><div id="fn8"><p><sup>8</sup>&nbsp;See <a href="http://matwbn.icm.edu.pl/ksiazki/aa/aa59/aa5935.pdf">here</a> for a summmary of asymptotics for this problem.</p></div></div><p><img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bn%5Cle%20x%7D%20a(n)%20%5Csim%20Ax%20+%20B%5Csqrt%7Bx%7D%20+%20Cx%5E%7B%5Cfrac%7B1%7D%7B3%7D%7D%20+%20O(x%5E%7B%5Cfrac%7B3%7D%7B10%7D%7D(%5Clog%20x)%5E%7B%5Cfrac%7B9%7D%7B10%7D%7D)"></p>
<p><img src="https://latex.codecogs.com/png.latex?A%20=%20%5Cprod_%7Bk=1,%20k%20%5Cne%201%7D%5E%5Cinfty%20%5Czeta(k)"></p>
<p><img src="https://latex.codecogs.com/png.latex?B%20=%20%5Cprod_%7Bk=1,%20k%20%5Cne%202%7D%5E%5Cinfty%20%5Czeta(%5Cfrac%7Bk%7D%7B2%7D)"></p>
<p><img src="https://latex.codecogs.com/png.latex?C%20=%20%5Cprod_%7Bk=1,%20k%20%5Cne%203%7D%5E%5Cinfty%20%5Czeta(%5Cfrac%7Bk%7D%7B3%7D)"></p>


</section>
</section>


 ]]></description>
  <category>group-theory</category>
  <category>zeta-function</category>
  <category>asymptotics</category>
  <guid>https://www.shoresofinfinity.net/posts/counting_abelian_groups/counting_abelian_groups.html</guid>
  <pubDate>Tue, 07 Oct 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Games As Graphs I: Bridges of Shangri-La</title>
  <dc:creator>Srinivas Vasudevan</dc:creator>
  <link>https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i.html</link>
  <description><![CDATA[ 




<p>This is a series on understanding various boardgames via graph representations, with this post focusing on the <a href="https://boardgamegeek.com/boardgame/8190/the-bridges-of-shangri-la">Bridges of Shangri-La</a> by Leo Colovini<sup>1</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><div class="quarto-figure quarto-figure-center"><sup>1</sup>&nbsp;
<figure class="figure">
<p><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/bridges_of_shangrila.webp" class="img-fluid figure-img"></p>
<figcaption>Image from BGG courtesy of <span class="citation" data-cites="fungry">@fungry</span></figcaption>
</figure>
</div>
</div></div><p>I’ve wanted to look at some games and write down mathematical descriptions for them. For me, this is a way to understand their design better, and also be a way to generate new ideas.</p>
<p>Since this is the first of several posts, I’ll describe some fundamentals of Graph Theory.</p>
<section id="graph-theory-primer" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="graph-theory-primer">Graph Theory Primer</h2>
<p>A <em>graph</em> <img src="https://latex.codecogs.com/png.latex?G"> is a set of <em>vertices</em> <img src="https://latex.codecogs.com/png.latex?V"> and a set of <em>edges</em> <img src="https://latex.codecogs.com/png.latex?E%20%5Csubset%20V%20%5Ctimes%20V">. We can draw these graphs pretty easily Figure&nbsp;1 .<sup>2</sup><sup>3</sup></p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;To differentiate the undirected and directed graph, we’d have to distinguish between ordered and unordered tuples, but I’m being intentionally not rigorous since the meaning is clear with pictures.</p></div><div id="fn3"><p><sup>3</sup>&nbsp;Note that a graph drawing is unique. We can move the edges and vertices around.</p></div></div><div id="cell-fig-simple-graphs" class="cell page-columns page-full" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="1">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-simple-graphs" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simple-graphs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-simple-graphs-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;1: Graphs on 4 vertices"><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-simple-graphs-output-1.png" width="299" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simple-graphs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Graphs on 4 vertices
</figcaption>
</figure>
</div>
</div></div></div>
<p>A graph where for all edges <img src="https://latex.codecogs.com/png.latex?(u,%20v)%20%5Cin%20E,%20u%20%5Cne%20v"> is called a simple graph (edges with the same start and end points are called <em>loops</em>).</p>
<p>Graphs can come in an <em>undirected</em> or <em>directed</em> flavor. In a directed graphs, the edges have an orientation (Figure&nbsp;1).</p>
<p>Edges and vertices may also have <em>weights</em> associated with them. These are typically used to assign costs. In general, different attributes can be assigned to an edge or vertex such as <em>color</em> (Figure&nbsp;2).</p>
<div id="cell-fig-complicated-graph" class="cell page-columns page-full" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="2">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-complicated-graph" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-complicated-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-complicated-graph-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;2: A more complicated graph on 10 vertices. Vertices are scaled by their edge weight w and are colored one of two colors."><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-complicated-graph-output-1.png" width="299" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-complicated-graph-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: A more complicated graph on 10 vertices. Vertices are scaled by their edge weight <img src="https://latex.codecogs.com/png.latex?w"> and are colored one of two colors.
</figcaption>
</figure>
</div>
</div></div></div>
<p>What does a graph represent? As much as limited by the imagination:</p>
<ul>
<li>The vertices <img src="https://latex.codecogs.com/png.latex?V"> could represent locations, and edges <img src="https://latex.codecogs.com/png.latex?E"> represent whether two locations are reachable from each other. This includes maps, road networks, but even things like chess positions for something like a <a href="https://en.wikipedia.org/wiki/Knight%27s_tour">Knight’s Tour</a>.</li>
<li>The vertices <img src="https://latex.codecogs.com/png.latex?V"> are individuals, and the edges <img src="https://latex.codecogs.com/png.latex?E"> represent contact. This could be used for something like a social network, but also disease modelling.</li>
<li>For a directed graph <img src="https://latex.codecogs.com/png.latex?G"> The vertices <img src="https://latex.codecogs.com/png.latex?V"> are tasks, and the edges <img src="https://latex.codecogs.com/png.latex?E"> represent which task has to be done before the next. This includes things like supply chain management.</li>
</ul>
<p>After representing something as a graph, there are a variety of algorithms to deduce things about the graph. Some common problems include finding the shortest path, determining if there is a cycle, graph coloring, etc.</p>
<p>We won’t be needing these but may encounter these in future discussions.</p>
</section>
<section id="bridges-of-shangri-la" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="bridges-of-shangri-la">Bridges of Shangri-La</h2>
<p>Bridges of Shangri-La is a game by Leo Colovini for 3-4 players. It takes place on a map representing monasteries in Tibet.</p>
<p>Your goal is to have the most number of masters out on the board after all the bridges have collapsed. Each master is worth 1 point.</p>
<p>Before I give a rough summary of the rules, I’ll depict the board as a map for simplicity of discussion <sup>4</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;This is the 4P map. The top right corner is excluded for the 3P game.</p></div></div><div id="cell-fig-bos" class="cell" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="3">
<div class="cell-output cell-output-display">
<div id="fig-bos" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-bos-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;3: Bridges of Shangri-La map as a graph."><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-bos-output-1.png" width="299" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bos-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Bridges of Shangri-La map as a graph.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Each vertex represents a village, and each edge represents a bridge. Each village also has 7 spots for the 7 different types of masters <sup>5</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><div class="quarto-figure quarto-figure-center"><sup>5</sup>&nbsp;
<figure class="figure">
<p><a href="village.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Example of placing masters"><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/village.png" class="img-fluid figure-img" alt="Example of placing masters"></a></p>
<figcaption>Example of placing masters</figcaption>
</figure>
</div>
</div></div><p>At the very beginning of the game, each player will place one of each type of master (in their player color) into villages of their choice. That will be 7 placements for each player. Each spot is exclusive.</p>
<p>On a players’ turn they have one of three actions:</p>
<ol type="1">
<li><p>Place a master: You can only do this in a village where you have a master of your color and if there is an unoccupied space.</p></li>
<li><p>Recruit students: You can place up to 2 students. You place a master tile on a master you already have, with the top tile called a student. Each master can only have one student.</p></li>
<li><p>The Journey of the Students: Choose two connected villages, and one of them being the one travelled from (“attacker”) and the other the (“defender”). The village that has the most tiles is considered stronger (with the village with the most masters and then “defender” breaking ties).</p>
<ul>
<li>If the “attacker” is stronger, than all students in the “attacking” village move over to the “defender”, occupying their corresponding space (removing opponents tiles if they are occupied).</li>
<li>If the “defender” is stronger, than students only move over to empty spots, and otherwise get discarded.</li>
<li>Afterwards, the bridge between the two villages gets destroyed.</li>
</ul></li>
</ol>
<p>Once all bridges are destroyed the game ends, with the player with the most masters on the board winning.</p>
<section id="graph-representation" class="level3">
<h3 class="anchored" data-anchor-id="graph-representation">Graph Representation</h3>
<p>As seen in Figure&nbsp;3, we can represent the game board as a graph. I’ll look at a simplified version of the game where there are only two types of masters (so that there are two slots in each village). For each type of master, we can have a copy of the graph as in Figure&nbsp;4.</p>
<p>To show the placement of a master, color the node the player color and set the weight to 1. Increasing the weight of a vertex to 2 will represent showing that there is a student.</p>
<div id="cell-fig-bos-copies" class="cell" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="4">
<div class="cell-output cell-output-display">
<div id="fig-bos-copies" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bos-copies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-bos-copies-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;4: In our simplified version we have two types of masters. Player placements of these masters is depicted by two separate graphs, one for each type of master."><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-bos-copies-output-1.png" width="587" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bos-copies-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: In our simplified version we have two types of masters. Player placements of these masters is depicted by two separate graphs, one for each type of master.
</figcaption>
</figure>
</div>
</div>
</div>
<p>For the actions have:</p>
<ol type="1">
<li><p>Place a master: Choose one of graph copies, and then choose a vertex with weight <img src="https://latex.codecogs.com/png.latex?0">, such that the same vertex already has a master of the player’s color in a different graph. Then color it your player color and change it’s weight to 1 (as seen in Figure&nbsp;5 (a))</p></li>
<li><p>Recruit students: Choose two vertices that have your color and are weight <img src="https://latex.codecogs.com/png.latex?1"> among the copies. Then increment their weight to <img src="https://latex.codecogs.com/png.latex?2"> (as seen in Figure&nbsp;5 (b))</p></li>
<li><p>The Journey of the Students: Essentially following the previous rules, with vertices of weight <img src="https://latex.codecogs.com/png.latex?2"> interacting and representing the movement of the students. To get the strength of a village, sum the weights of the nodes in all copies of that vertex (the effect is seen in Figure&nbsp;5 (c)).</p></li>
</ol>
<div class="cell" data-fig-height="1" data-fig-width="1" data-layout-nrows="3" data-message="false" data-execution_count="5">
<div id="fig-bos-actions" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="5" data-fig-height="1" data-layout-nrows="3" data-message="false" data-fig-width="1">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-bos-actions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display">
<div id="fig-bos-actions-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-bos-actions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-bos-actions-output-1.png" class="lightbox" data-gallery="fig-bos-actions" title="Figure&nbsp;5&nbsp;(a): Orange placing a master of the first type."><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-bos-actions-output-1.png" data-ref-parent="fig-bos-actions" width="587" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bos-actions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Orange placing a master of the first type.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-bos-actions-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-bos-actions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-bos-actions-output-2.png" class="lightbox" data-gallery="fig-bos-actions" title="Figure&nbsp;5&nbsp;(b): Blue adding a student to each of their masters."><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-bos-actions-output-2.png" data-ref-parent="fig-bos-actions" width="587" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bos-actions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Blue adding a student to each of their masters.
</figcaption>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div id="fig-bos-actions-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-bos-actions-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="games_as_graphs_i_files/figure-html/fig-bos-actions-output-3.png" class="lightbox" data-gallery="fig-bos-actions" title="Figure&nbsp;5&nbsp;(c): Any player initiating a journey of students."><img src="https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i_files/figure-html/fig-bos-actions-output-3.png" data-ref-parent="fig-bos-actions" width="587" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-bos-actions-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Any player initiating a journey of students.
</figcaption>
</figure>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-bos-actions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Showing Bridges of Shangri-La actions in graph form.
</figcaption>
</figure>
</div>
</div>
</section>
</section>
<section id="game-analysis" class="level2">
<h2 class="anchored" data-anchor-id="game-analysis">Game Analysis</h2>
<p>First for the map, we have each vertex has at most 4 edges. That is the <em>degree</em> of a vertex is atmost 4, and in fact <img src="https://latex.codecogs.com/png.latex?3%20%5Cle%20deg(v)%20%5Cle%204,%5C,%20%20%5Cforall%20v%20%5Cin%20V">.</p>
<ul>
<li>The fact the number of edges varies a little bit breaks some symmetry, with the right / top-right of the board having smaller degree vertices, and so makes the initial placement a little more meaningful.</li>
</ul>
<p>Note also that when a spot is filled with a master, it will always be filled. This is because it either gains a master or gets displaced. This is also clear from looking at the weights of a vertex. If a vertex is positive, it will continue to be positive for the rest of the game.</p>
<ul>
<li>This means that the game starts to narrow as there are fewer places to a master.</li>
</ul>
<p>For almost all the discussion above, we haven’t needed graph theory, which begs the question why do any of this? For myself, I think it strips out ancillary (yet important details such as theme, etc.) details and gives a mathematical representation that can be manipulated. Viewing a game through the right lense could be suggestive of some design principals.</p>
<p>For instance, in the above representation I chose to have the game board be represented as multiple copies, with each copy representing a specific type of master / and it’s corresponding slots.</p>
<p>This is interesting because it is suggestive of a game design principle: create independent simple games, and then correlate them / make them interact through a few different actions to add complexity and shared incentives.</p>
<p>Indeed, you can think of the 7 copies as separate games. The master placement rule requires some colocality of changing a vertex (you can only change a weight 0 vertex to weight 1, if it is at least weight 1 and your color in some copy). And the journey of the students requires evaluating the strength of a village. But after that, the student movements/placements can be treated independently.</p>
<p>I think this does several different things:</p>
<ul>
<li>With the game being similar to 7 independent subgames, some of the reasoning gets simplified (since different types of masters don’t directly interact).</li>
<li>Master placement colocality means predicting what an opponent can do is easier. This constraint is useful for making the game more strategic (and also intuitive rules-wise).</li>
<li>Evaluating the strength of a village directly correlates different types of masters. This allows for shared incentives to emerge with different players.</li>
</ul>
<p>Another thing is the game can be viewed very coarsely as a series of edge deletions. This then brings up questions for design, by looking at ablations of mathematical properties:</p>
<ul>
<li>How does this game feel if some edges are directed?</li>
<li>What if edge deletion was replaced by other graph operations? For example edge contraction combines two vertices (while removing the edge between them), and retains all the edges coming to/from those vertices. We can mix and match different graph operations and think about how that would influence game play.</li>
<li>What if edges get deleted / removed for different types of masters? Specifically the journey of the students would delete an edge for some subset of the 7 copies of the graph (rather than all of them), so that certain students can still travel.</li>
</ul>
<p>Overall, by writing a mathematical representation we can get quite a few ideas on how to modify / get inspired to make games that retain some of the feeling of this one.</p>


</section>


 ]]></description>
  <category>board-game</category>
  <category>graph-theory</category>
  <guid>https://www.shoresofinfinity.net/posts/games_as_graphs_i/games_as_graphs_i.html</guid>
  <pubDate>Mon, 22 Sep 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Trapezoid Rule Monte Carlo</title>
  <dc:creator>Srinivas Vasudevan</dc:creator>
  <link>https://www.shoresofinfinity.net/posts/trapezoid_mc/quad_mc.html</link>
  <description><![CDATA[ 




<p>I recently encountered a Monte Carlo estimator <span class="citation" data-cites="masry1990">(Masry and Cambanis 1990)</span> that uses the trapezoid rule and wanted to write out / generalize it.</p>
<div class="no-row-height column-margin column-container"><div id="ref-masry1990" class="csl-entry">
Masry, Elias, and Stamatis Cambanis. 1990. <span>“Trapezoidal Monte Carlo Integration.”</span> <em>SIAM Journal on Numerical Analysis</em> 27 (2): 225–46. <a href="https://apps.dtic.mil/sti/tr/pdf/ADA222380.pdf">https://apps.dtic.mil/sti/tr/pdf/ADA222380.pdf</a>.
</div><div id="fn1"><p><sup>1</sup>&nbsp;Methods such as Clenshaw-Curtis or Gaussian Quadrature can do very well on smooth integrands with errors of <img src="https://latex.codecogs.com/png.latex?%7B%5Cdisplaystyle%20O(%5B2N%5D%5E%7B-k%7D/k)%7D">, where <img src="https://latex.codecogs.com/png.latex?N"> is the number of quadrature points, and <img src="https://latex.codecogs.com/png.latex?k"> is the number of derivatives <img src="https://latex.codecogs.com/png.latex?f"> has.</p></div></div><p>Given a function <img src="https://latex.codecogs.com/png.latex?f"> (we’ll assume <img src="https://latex.codecogs.com/png.latex?f"> is <img src="https://latex.codecogs.com/png.latex?C%5E%5Cinfty"> for simplicity, but some of these arguments can be changed depending on the smoothness) defined on the unit interval <img src="https://latex.codecogs.com/png.latex?%5B0,%201%5D">, we would like to compute the integral <img src="https://latex.codecogs.com/png.latex?I%20=%20%5Cint_0%5E1%20f(x)%20dx">. Quadrature methods can easily deal with estimating these integrals <sup>1</sup></p>
<p>Our plan will be to come up with a lower variance (but biased) estimator, and then generalize to computing integrals of the form <img src="https://latex.codecogs.com/png.latex?%5Cint_A%20f(x)%20p(x)%20dx">, where <img src="https://latex.codecogs.com/png.latex?p(x)"> is a probability density on some subset of <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BR%7D">. Finally, we’ll be able to get an estimator even if we only have access to a sampler and the unnormalized log density (e.g.&nbsp;in the case of MCMC).</p>
<p>The typical Monte-Carlo estimator for this type of integral is <img src="https://latex.codecogs.com/png.latex?S_n%20=%20%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi=1%7D%5En%20f(u_i)">, where <img src="https://latex.codecogs.com/png.latex?u_i%20%5Csim%20U(0,%201)"> are IID uniform samples. This is an unbiased estimator for <img src="https://latex.codecogs.com/png.latex?I"> and has variance <img src="https://latex.codecogs.com/png.latex?var(S_n)%20=%20%5Cfrac%7Bvar(f)%7D%7Bn%7D">, where <img src="https://latex.codecogs.com/png.latex?var(f)"> is the variance of the random variable <img src="https://latex.codecogs.com/png.latex?f(U),%20U%20%5Csim%20U(0,%201)">. In particular the variance is inversely proportional to <img src="https://latex.codecogs.com/png.latex?n">.</p>
<section id="trapezoid-rule-estimator" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="trapezoid-rule-estimator">Trapezoid Rule Estimator</h2>
<p>If we look at error estimates of various quadrature rules, we see that the errors get better dependency than <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7B%5Csqrt%20n%7D)"> for estimating <img src="https://latex.codecogs.com/png.latex?I">.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>We can see from the table that we can get errors <img src="https://latex.codecogs.com/png.latex?S_n%20-%20I"> that are at least <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5E2%7D)"> for various Newton-Cotes formula. From <a href="https://en.wikipedia.org/wiki/Newton%E2%80%93Cotes_formulas">wikipedia</a>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 55%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Name</th>
<th style="text-align: center;">Error Bound</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Trapezoid Rule</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7B1%7D%7B12n%5E2%7Df''(%5Cxi)"></td>
</tr>
<tr class="even">
<td style="text-align: right;">Simpson’s <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B3%7D"> rule Rule</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7B1%7D%7B90n%5E4%7Df%5E%7B(4)%7D(%5Cxi)"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">Boole’s Rule</td>
<td style="text-align: center;"><img src="https://latex.codecogs.com/png.latex?-%5Cfrac%7B8%7D%7B945n%5E6%7Df%5E%7B(6)%7D(%5Cxi)"></td>
</tr>
</tbody>
</table>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Cxi"> lies in the interval of integration <img src="https://latex.codecogs.com/png.latex?%5Ba,%20b%5D">.</p>
</div></div><p>The main idea is we can exploit the structure of the trapezoid rule (and in general Newton-Cotes rules) to get better scaling of the variance with respect to the number of samples <img src="https://latex.codecogs.com/png.latex?n">.</p>
<p>Given <img src="https://latex.codecogs.com/png.latex?n"> samples <img src="https://latex.codecogs.com/png.latex?u_i%20%5Csim%20U(0,%201)">, we can sort the samples to form the order statistics <img src="https://latex.codecogs.com/png.latex?v_i">. We’ll also add the points <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?1"> to get <img src="https://latex.codecogs.com/png.latex?n%20+%201"> points (let <img src="https://latex.codecogs.com/png.latex?v_0%20=%200"> and <img src="https://latex.codecogs.com/png.latex?v_%7Bn%20+%201%7D%20=%201">).</p>
<p>We can then consider the trapezoid rule estimator: <img src="https://latex.codecogs.com/png.latex?S'_n%20=%20%5Csum_%7Bi=0%7D%5E%7Bn%7D%20%5Cfrac%7B1%7D%7B2%7D%20(v_%7Bi+1%7D%20-%20v_i)(f(v_%7Bi+1%7D)%20+%20f(v_i))"></p>
<div id="cell-fig-trap-margin" class="cell page-columns page-full" data-fig-height="1" data-fig-width="1" data-message="false" data-execution_count="1">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-trap-margin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trap-margin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="quad_mc_files/figure-html/fig-trap-margin-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Randomized Trapezoid Rule for \sin(\frac{\pi}{2} x)"><img src="https://www.shoresofinfinity.net/posts/trapezoid_mc/quad_mc_files/figure-html/fig-trap-margin-output-1.png" width="299" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trap-margin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Randomized Trapezoid Rule for <img src="https://latex.codecogs.com/png.latex?%5Csin(%5Cfrac%7B%5Cpi%7D%7B2%7D%20x)">
</figcaption>
</figure>
</div>
</div></div></div>
<p>The intuition is that for sufficiently smooth <img src="https://latex.codecogs.com/png.latex?f">, <img src="https://latex.codecogs.com/png.latex?S'_n"> should be a good estimator of the integral <img src="https://latex.codecogs.com/png.latex?I"> due to the use of the trapezoid rule. Note that <img src="https://latex.codecogs.com/png.latex?S'_n"> may be biased, and indeed Figure&nbsp;1 shows an example of this, where the trapezoid rule approximates the integral well, but will always be an underestimate due to the concavity of the integrand. The hope is that we may trade off some bias for a reduction in variance.</p>
<p>As mentioned above, we can note the following deficiencies of this method, compared to quadrature rules and monte carlo rules.</p>
<ul>
<li>This can be a biased estimator.</li>
<li>This is for <img src="https://latex.codecogs.com/png.latex?U(0,%201)"> random variables and in one dimension, for which there are better methods.</li>
<li>In the current formulation, you have to evaluate the endpoints <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?1">. This can be problematic for integrands (such as certain <img src="https://latex.codecogs.com/png.latex?Beta(%5Calpha,%20%5Cbeta)"> densities which go off to <img src="https://latex.codecogs.com/png.latex?%5Cinfty"> in the tails). We can actually get away with <img src="https://latex.codecogs.com/png.latex?n"> points without evaluating the <img src="https://latex.codecogs.com/png.latex?0"> and <img src="https://latex.codecogs.com/png.latex?1"> points. Adding the points just simplifies the analysis and reduces the error by a constant.</li>
</ul>
</section>
<section id="error-bound-on-s_n" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="error-bound-on-s_n">Error bound on <img src="https://latex.codecogs.com/png.latex?S'_n"></h2>
<p>Let’s take a look at the error <img src="https://latex.codecogs.com/png.latex?S'_n%20-%20I">.</p>
<p>For simplicity we’ll reuse a form of the Trapezoid Rule Error <sup>2</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;See <a href="https://mathweb.ucsd.edu/~ebender/20B/77_Trap.pdf">here</a></p></div></div><p>If we are estimating <img src="https://latex.codecogs.com/png.latex?%5Cint_%7Bv_i%7D%5E%7Bv_%7Bi+1%7D%7D%20f(x)%20dx">, then the error of using <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B2%7D(f(v_%7Bi+1%7D)%20+%20f(v_%7Bi%7D))(v_%7Bi+1%7D%20-%20v_i)"> is bounded by <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BK_i(v_%7Bi+1%7D%20-%20v_i)%5E3%7D%7B12%7D">, where <img src="https://latex.codecogs.com/png.latex?K_i%20=%20%5Csup_%7B%5Bv_i,%20v_%7Bi+1%7D%5D%7D%20%7Cf''(x)%7C"> (this can be derived through repeated applications of the Mean Value Theorem).</p>
<p><img src="https://latex.codecogs.com/png.latex?%7CS'_n%20-%20I%7C%20=%20%7C-%5Cint_0%5E1%20f(x)%20dx%20+%20%5Csum_%7Bi=0%7D%5E%7Bn%7D%5Cfrac%7B1%7D%7B2%7D(v_%7Bi+1%7D%20-%20v_i)%20(f(v_%7Bi+1%7D)%20-%20f(v_i))%7C"></p>
<p><img src="https://latex.codecogs.com/png.latex?=%7C%5Csum_%7Bi=0%7D%5E%7Bn%7D%5Cfrac%7B1%7D%7B2%7D(v_%7Bi+1%7D%20-%20v_i)%20(f(v_%7Bi+1%7D)%20+%20f(v_i))%20-%20%5Cint_%7Bv_i%7D%5E%7Bv_%7Bi+1%7D%7D%20f(x)%20dx%7C"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cle%5Csum_%7Bi=0%7D%5E%7Bn%7D%7C%5Cfrac%7B1%7D%7B2%7D(v_%7Bi+1%7D%20-%20v_i)%20(f(v_%7Bi+1%7D)%20+%20f(v_i))%20-%20%5Cint_%7Bv_i%7D%5E%7Bv_%7Bi+1%7D%7D%20f(x)%20dx%7C"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cle%5Csum_%7Bi=0%7D%5E%7Bn%7D%5Cfrac%7BK_i%7D%7B12%7D(v_%7Bi%20+%201%7D%20-%20v_i)%5E3"></p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cle%5Cfrac%7BK%7D%7B12%7D%5Csum_%7Bi=0%7D%5E%7Bn%7D(v_%7Bi%20+%201%7D%20-%20v_i)%5E3"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?x_i%20=%20v_%7Bi+1%7D%20-%20v_i">. It’s well known that these lengths are jointly distributed like a Dirichlet <sup>3</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn3"><p><sup>3</sup>&nbsp;See <a href="https://statisticaloddsandends.wordpress.com/2021/04/20/generating-random-draws-from-the-dir1-1-1-distribution-using-the-uniform-distribution/">here</a></p></div></div><p>This makes the <img src="https://latex.codecogs.com/png.latex?(x_0,%20...%20,%20x_%7Bn%7D)%20%5Csim%20Dirichlet(1,%201,%20....,%201)"></p>
<p>We’ll use the following properties of moments of the Dirichlet distribution <span class="citation" data-cites="lin2016">(n.d.)</span>.</p>
<div class="no-row-height column-margin column-container"><div id="ref-lin2016" class="csl-entry">
Lin, Jiayu. n.d. <span>“On the Dirichlet Distribution.”</span> <a href="https://mast.queensu.ca/~communications/Papers/msc-jiayu-lin.pdf">https://mast.queensu.ca/~communications/Papers/msc-jiayu-lin.pdf</a>.
</div></div><p><img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BX_i%5Ek%5D%20=%20%5Cfrac%7B%5CGamma(n)%7D%7B%5CGamma(n%20+%20k)%7D%20%5Cfrac%7B%5CGamma(k%20+%201)%7D%7B%5CGamma(1)%7D%20=%20%5Cfrac%7B(n%20-%201)!k!%7D%7B(n%20+%20k%20-%201)!%7D%20=%20%5Cfrac%7Bk!%7D%7Bn%20(n%20+%201)%20(n%20+%202)%20...%20(n%20+%20k%20-%201)%7D"> <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BX_i%5EkX_j%5Ek%5D%20=%20%5Cfrac%7B%5CGamma(n)%7D%7B%5CGamma(n%20+%202k)%7D%20%5Cfrac%7B%5CGamma(k%20+%201)%5E2%7D%7B%5CGamma(1)%7D%20=%20%5Cfrac%7B(n%20-%201)!(k!)%5E2%7D%7B(n%20+%202k%20-%201)!%7D%20=%20%5Cfrac%7Bk!%5E2%7D%7Bn%20(n%20+%201)%20(n%20+%202)%20...%20(n%20+%202k%20-%201)%7D"></p>
<p>That is the <img src="https://latex.codecogs.com/png.latex?k">-th marginal moment grows like <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5Ek%7D)">. and that the mixed moment <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5BX_i%5EkX_j%5Ek%5D"> grows like <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5E%7B2k%7D%7D)">.</p>
<p>We can look at <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B(S'_n%20-%20I)%5E2%5D%20=%20%5Cmathbb%7BE%7D%5B(%5Cfrac%7BK%7D%7B12%7D)%5E2%20(%5Csum_%7Bi=0%7D%5E%7Bn%20+%201%7D(x_i)%5E3)%5E2%5D"> = <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BK%5E2%7D%7B144%7D%5Csum_%7Bi,%20j%7D%20%5Cmathbb%7BE%7D%5Bx_i%5E3x_j%5E3%5D"></p>
<p>As the sum over the <img src="https://latex.codecogs.com/png.latex?(n%20+%202)%5E2"> terms is over moments which are all <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5E6%7D)">, this results in <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B(S'_n%20-%20I)%5E2)%5D%20=%20O(%5Cfrac%7B1%7D%7Bn%5E4%7D)"> (with an <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5E2%7D)"> bound on the bias) <sup>4</sup>. A precise bound can be derived by carrying through the constants from the Trapezoid Rule and the Dirichlet moments.</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;One can easily get an error bound on the bias <img src="https://latex.codecogs.com/png.latex?%7C%5Cmathbb%7BE%7D%5BS'_n%20-%20I%5D%7C"> without squaring the sum. Mainly looking at <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B(S'_n%20-%20I)%5E2%5D"> gives us a stronger form of convergence, and one can still recover a bound on the bias.</p></div></div></section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<p>Here’s some example on a few different functions on <img src="https://latex.codecogs.com/png.latex?%5B0,%201%5D"></p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?f%20=%20%5Cfrac%7B1%7D%7B1%20+%20x%5E2%7D"></li>
<li><img src="https://latex.codecogs.com/png.latex?g%20=%20e%5Ex%5Csin(%5Cfrac%7Bx%7D%7B2%7D)"></li>
<li><img src="https://latex.codecogs.com/png.latex?h%20=%20x%5E3%20-%20x%20+%20x%5E2">.</li>
</ul>
<div class="cell" data-message="false" data-results="asis" data-tbl-format="none" data-layout-nrow="3" data-execution_count="2">
<div id="tbl-error" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Absolute Error in estimating the integral of <img src="https://latex.codecogs.com/png.latex?f%20=%20%5Cfrac%7B1%7D%7B1%20+%20x%5E2%7D">, <img src="https://latex.codecogs.com/png.latex?g%20=%20e%5Ex%20%5Csin(%5Cfrac%7Bx%7D%7B2%7D)">, <img src="https://latex.codecogs.com/png.latex?h%20=%20x%5E3%20-%20x%20+%20x%5E2">.
</figcaption>
<div aria-describedby="tbl-error-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<style type="text/css">
</style>

<table id="T_3ba45" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_3ba45_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Integral</th>
<th id="T_3ba45_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th id="T_3ba45_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">N=10</th>
<th id="T_3ba45_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">N=50</th>
<th id="T_3ba45_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">N=100</th>
<th id="T_3ba45_level0_col5" class="col_heading level0 col5" style="text-align: left;" data-quarto-table-cell-role="th">N=200</th>
<th id="T_3ba45_level0_col6" class="col_heading level0 col6" style="text-align: left;" data-quarto-table-cell-role="th">N=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_3ba45_row0_col0" class="data row0 col0" style="text-align: left;">0.785398</td>
<td id="T_3ba45_row0_col1" class="data row0 col1" style="text-align: left;">Monte Carlo</td>
<td id="T_3ba45_row0_col2" class="data row0 col2" style="text-align: left;">0.026491</td>
<td id="T_3ba45_row0_col3" class="data row0 col3" style="text-align: left;">0.019358</td>
<td id="T_3ba45_row0_col4" class="data row0 col4" style="text-align: left;">0.008144</td>
<td id="T_3ba45_row0_col5" class="data row0 col5" style="text-align: left;">0.002608</td>
<td id="T_3ba45_row0_col6" class="data row0 col6" style="text-align: left;">0.001540</td>
</tr>
<tr class="even">
<td id="T_3ba45_row1_col0" class="data row1 col0" style="text-align: left;">0.785398</td>
<td id="T_3ba45_row1_col1" class="data row1 col1" style="text-align: left;">Trapezoid Rule</td>
<td id="T_3ba45_row1_col2" class="data row1 col2" style="text-align: left;">0.000393</td>
<td id="T_3ba45_row1_col3" class="data row1 col3" style="text-align: left;">0.000010</td>
<td id="T_3ba45_row1_col4" class="data row1 col4" style="text-align: left;">0.000038</td>
<td id="T_3ba45_row1_col5" class="data row1 col5" style="text-align: left;">0.000009</td>
<td id="T_3ba45_row1_col6" class="data row1 col6" style="text-align: left;">0.000000</td>
</tr>
<tr class="odd">
<td id="T_3ba45_row2_col0" class="data row2 col0" style="text-align: left;">0.785398</td>
<td id="T_3ba45_row2_col1" class="data row2 col1" style="text-align: left;">Simpson's 1/3 Rule</td>
<td id="T_3ba45_row2_col2" class="data row2 col2" style="text-align: left;">0.000002</td>
<td id="T_3ba45_row2_col3" class="data row2 col3" style="text-align: left;">0.000010</td>
<td id="T_3ba45_row2_col4" class="data row2 col4" style="text-align: left;">0.000001</td>
<td id="T_3ba45_row2_col5" class="data row2 col5" style="text-align: left;">0.000000</td>
<td id="T_3ba45_row2_col6" class="data row2 col6" style="text-align: left;">0.000000</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-row">
<style type="text/css">
</style>

<table id="T_c1887" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_c1887_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Integral</th>
<th id="T_c1887_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th id="T_c1887_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">N=10</th>
<th id="T_c1887_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">N=50</th>
<th id="T_c1887_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">N=100</th>
<th id="T_c1887_level0_col5" class="col_heading level0 col5" style="text-align: left;" data-quarto-table-cell-role="th">N=200</th>
<th id="T_c1887_level0_col6" class="col_heading level0 col6" style="text-align: left;" data-quarto-table-cell-role="th">N=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_c1887_row0_col0" class="data row0 col0" style="text-align: left;">0.488364</td>
<td id="T_c1887_row0_col1" class="data row0 col1" style="text-align: left;">Monte Carlo</td>
<td id="T_c1887_row0_col2" class="data row0 col2" style="text-align: left;">0.146778</td>
<td id="T_c1887_row0_col3" class="data row0 col3" style="text-align: left;">0.003383</td>
<td id="T_c1887_row0_col4" class="data row0 col4" style="text-align: left;">0.026795</td>
<td id="T_c1887_row0_col5" class="data row0 col5" style="text-align: left;">0.034787</td>
<td id="T_c1887_row0_col6" class="data row0 col6" style="text-align: left;">0.009164</td>
</tr>
<tr class="even">
<td id="T_c1887_row1_col0" class="data row1 col0" style="text-align: left;">0.488364</td>
<td id="T_c1887_row1_col1" class="data row1 col1" style="text-align: left;">Trapezoid Rule</td>
<td id="T_c1887_row1_col2" class="data row1 col2" style="text-align: left;">0.005188</td>
<td id="T_c1887_row1_col3" class="data row1 col3" style="text-align: left;">0.000636</td>
<td id="T_c1887_row1_col4" class="data row1 col4" style="text-align: left;">0.000118</td>
<td id="T_c1887_row1_col5" class="data row1 col5" style="text-align: left;">0.000022</td>
<td id="T_c1887_row1_col6" class="data row1 col6" style="text-align: left;">0.000001</td>
</tr>
<tr class="odd">
<td id="T_c1887_row2_col0" class="data row2 col0" style="text-align: left;">0.488364</td>
<td id="T_c1887_row2_col1" class="data row2 col1" style="text-align: left;">Simpson's 1/3 Rule</td>
<td id="T_c1887_row2_col2" class="data row2 col2" style="text-align: left;">0.000131</td>
<td id="T_c1887_row2_col3" class="data row2 col3" style="text-align: left;">0.000002</td>
<td id="T_c1887_row2_col4" class="data row2 col4" style="text-align: left;">0.000000</td>
<td id="T_c1887_row2_col5" class="data row2 col5" style="text-align: left;">0.000000</td>
<td id="T_c1887_row2_col6" class="data row2 col6" style="text-align: left;">0.000000</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-row">
<style type="text/css">
</style>

<table id="T_cd5eb" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_cd5eb_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Integral</th>
<th id="T_cd5eb_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th id="T_cd5eb_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">N=10</th>
<th id="T_cd5eb_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">N=50</th>
<th id="T_cd5eb_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">N=100</th>
<th id="T_cd5eb_level0_col5" class="col_heading level0 col5" style="text-align: left;" data-quarto-table-cell-role="th">N=200</th>
<th id="T_cd5eb_level0_col6" class="col_heading level0 col6" style="text-align: left;" data-quarto-table-cell-role="th">N=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_cd5eb_row0_col0" class="data row0 col0" style="text-align: left;">0.083333</td>
<td id="T_cd5eb_row0_col1" class="data row0 col1" style="text-align: left;">Monte Carlo</td>
<td id="T_cd5eb_row0_col2" class="data row0 col2" style="text-align: left;">0.178741</td>
<td id="T_cd5eb_row0_col3" class="data row0 col3" style="text-align: left;">0.057350</td>
<td id="T_cd5eb_row0_col4" class="data row0 col4" style="text-align: left;">0.007101</td>
<td id="T_cd5eb_row0_col5" class="data row0 col5" style="text-align: left;">0.011000</td>
<td id="T_cd5eb_row0_col6" class="data row0 col6" style="text-align: left;">0.000868</td>
</tr>
<tr class="even">
<td id="T_cd5eb_row1_col0" class="data row1 col0" style="text-align: left;">0.083333</td>
<td id="T_cd5eb_row1_col1" class="data row1 col1" style="text-align: left;">Trapezoid Rule</td>
<td id="T_cd5eb_row1_col2" class="data row1 col2" style="text-align: left;">0.011265</td>
<td id="T_cd5eb_row1_col3" class="data row1 col3" style="text-align: left;">0.001467</td>
<td id="T_cd5eb_row1_col4" class="data row1 col4" style="text-align: left;">0.000173</td>
<td id="T_cd5eb_row1_col5" class="data row1 col5" style="text-align: left;">0.000051</td>
<td id="T_cd5eb_row1_col6" class="data row1 col6" style="text-align: left;">0.000002</td>
</tr>
<tr class="odd">
<td id="T_cd5eb_row2_col0" class="data row2 col0" style="text-align: left;">0.083333</td>
<td id="T_cd5eb_row2_col1" class="data row2 col1" style="text-align: left;">Simpson's 1/3 Rule</td>
<td id="T_cd5eb_row2_col2" class="data row2 col2" style="text-align: left;">0.004317</td>
<td id="T_cd5eb_row2_col3" class="data row2 col3" style="text-align: left;">0.000017</td>
<td id="T_cd5eb_row2_col4" class="data row2 col4" style="text-align: left;">0.000001</td>
<td id="T_cd5eb_row2_col5" class="data row2 col5" style="text-align: left;">0.000000</td>
<td id="T_cd5eb_row2_col6" class="data row2 col6" style="text-align: left;">0.000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We can see that the error of the estimates from the Trapezoid Monte Carlo estimator seem to decrease very rapidly.</p>
</section>
<section id="improving-the-estimator" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="improving-the-estimator">“Improving” the Estimator</h2>
<p>The above estimator can be extended to other Newton-Cotes-type estimators. A Newton-Cotes formula is an integration rule that estimates the integral via the integration of a polynomial interpolant on <img src="https://latex.codecogs.com/png.latex?k%20+%201"> equally spaced points.</p>
<p>For instance, the trapezoid rule is just the integral of the linear polynomial between two equally spaced points.</p>
<p>For our purposes, we can take the interpolant and use it to derive an integration rule on non-qequally spaced points.</p>
<p>A Simpson’s Rule-type estimator, for instance would be of order 2 and use the <img src="https://latex.codecogs.com/png.latex?3"> points next to each other (as seen in Figure&nbsp;2).</p>
<div id="cell-fig-simpson-margin" class="cell page-columns page-full" data-fig-height="0.001" data-fig-width="0.001" data-message="false" data-execution_count="3">

<div class="no-row-height column-margin column-container"><div class="cell-output cell-output-display">
<div id="fig-simpson-margin" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-simpson-margin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="quad_mc_files/figure-html/fig-simpson-margin-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Randomized Simpson Rule for \sin(2 \pi x)"><img src="https://www.shoresofinfinity.net/posts/trapezoid_mc/quad_mc_files/figure-html/fig-simpson-margin-output-1.png" width="299" height="299" class="figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-simpson-margin-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Randomized Simpson Rule for <img src="https://latex.codecogs.com/png.latex?%5Csin(2%20%5Cpi%20x)">
</figcaption>
</figure>
</div>
</div></div></div>
<p>The interpolating polynomial through the ordered points <img src="https://latex.codecogs.com/png.latex?a,%20b,%20c"> would be <img src="https://latex.codecogs.com/png.latex?p(x)%20=%20f(a)%5Cfrac%7B(c%20-%20x)(b%20-%20x)%7D%7B(c%20-%20a)(b%20-%20a)%7D%20+%20f(b)%5Cfrac%7B(c%20-%20x)(a%20-%20x)%7D%7B(c%20-%20b)(a%20-%20c)%7D%20+%20f(c)%5Cfrac%7B(a%20-%20x)(b%20-%20x)%7D%7B(a%20-%20c)(b%20-%20c)%7D">.</p>
<p>Then <img src="https://latex.codecogs.com/png.latex?%5Cint_a%5Ec%20p(x)%20dx%20=%20-%5Cfrac%7B(a%20-%20c)(f(b)(a%20-%20c)%5E2%20+%20f(a)(c%20-%20b)(2(b%20-%20a)%20-%20(c%20-%20b))%20+%20f(c)(b%20-%20a)(2(c%20-%20b)%20-%20(b%20-%20a)))%7D%7B6(b%20-%20a)(c%20-%20b)%7D"></p>
<p>If we call this result <img src="https://latex.codecogs.com/png.latex?g(a,%20b,%20c)">, then we can form the estimator</p>
<p><img src="https://latex.codecogs.com/png.latex?S''_n%20=%20%5Csum_%7Bi=0%7D%5E%7B%5Cfrac%7Bn%20-%201%7D%7B2%7D%7D%20g(v_%7B2i%7D,%20v_%7B2i+1%7D,%20v_%7B2i+2%7D)"></p>
<p>Error analysis for this can proceed in a similar way (though very messily), which should result in an estimator with <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B(S''_n%20-%20I)%5E2%5D%20=%20O(%5Cfrac%7B1%7D%7Bn%5E8%7D)">. Similary we should have a <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5E4%7D)"> bound on the bias.</p>
<p>In general, we can set up estimators from larger interpolating polynomials, to get asymptotically faster converging estimators <sup>5</sup><sup>6</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;Note that polynomial interpolation on equally spaced points can be very numerically unstable. These estimators defend against this by being on random points, but some care needs to be taken.</p></div><div id="fn6"><p><sup>6</sup>&nbsp;Note that while the Dirichlet moments will decay faster in <img src="https://latex.codecogs.com/png.latex?n"> for higher order interpolants, they also pick up larger constants.</p></div></div><p>As seen in Table&nbsp;1, we empirically get faster convergence with the Simpson’s-rule type estimator.</p>
</section>
<section id="extending-to-other-probability-distributions" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="extending-to-other-probability-distributions">Extending to other probability distributions</h2>
<p>Suppose now we have <img src="https://latex.codecogs.com/png.latex?%5Cint_%7B%5Ba,%20b%5D%7D%20f(x)%20p(x)%20dx">, where <img src="https://latex.codecogs.com/png.latex?p(x)"> is some probability density on some interval <img src="https://latex.codecogs.com/png.latex?%5Ba,%20b%5D"></p>
<p>The Monte Carlo estimate would be <img src="https://latex.codecogs.com/png.latex?%5Csum_%7Bi=0%7D%5E%7Bn-1%7D%20f(x_i)">, where <img src="https://latex.codecogs.com/png.latex?x_i%20%5Csim%20p(x)">. We would like to use our trapezoid estimator here, where we now have samples from <img src="https://latex.codecogs.com/png.latex?p(x)"> rather than uniform samples.</p>
<p>We can naively apply the estimator by computing order statistics of <img src="https://latex.codecogs.com/png.latex?x_i">, called <img src="https://latex.codecogs.com/png.latex?z_i">, appending <img src="https://latex.codecogs.com/png.latex?a"> and <img src="https://latex.codecogs.com/png.latex?b"> to the ends much like before.</p>
<p>This gives the estimator <img src="https://latex.codecogs.com/png.latex?S'_n%20=%20%5Csum_%7Bi=0%7D%5En%20%5Cfrac%7B1%7D%7B2%7D(z_%7Bi+1%7D%20-%20z_i)%20(f(z_%7Bi+1%7D)p(z_%7Bi+1%7D)%20-%20f(z_i)p(z_i))"></p>
<p>Let <img src="https://latex.codecogs.com/png.latex?v_i%20=%20F(z_i)">, where <img src="https://latex.codecogs.com/png.latex?F"> is the CDF (we’ll assume this is completely differentiable). Then we have</p>
<p><img src="https://latex.codecogs.com/png.latex?S'_n%20=%20%5Csum_%7Bi=0%7D%5En%20%5Cfrac%7B1%7D%7B2%7D(z_%7Bi+1%7D%20-%20z_i)%20(f(z_%7Bi+1%7D)p(z_%7Bi+1%7D)%20-%20f(z_i)p(z_i)))"></p>
<p><img src="https://latex.codecogs.com/png.latex?=%20%5Csum_%7Bi=0%7D%5En%20%5Cfrac%7B1%7D%7B2%7D(F%5E%7B-1%7D(v_%7Bi+1%7D)-%20F%5E%7B-1%7D(v_i))%20(f(F%5E%7B-1%7D(v_%7Bi+1%7D))p(F%5E%7B-1%7D(v_%7Bi+1%7D))%20-%20f(F%5E%7B-1%7D(v_i))p(F%5E%7B-1%7D(v_%7Bi+1%7D)))"></p>
<p>Via an application of the Mean Value Theorem we have: <img src="https://latex.codecogs.com/png.latex?S'_n%20=%20%5Csum_%7Bi=0%7D%5En%20%5Cfrac%7B1%7D%7B2%7DF'%5E%7B-1%7D(s_i)%20(v_%7Bi+1%7D%20-%20v_i)(f(F%5E%7B-1%7D(v_%7Bi+1%7D))p(F%5E%7B-1%7D(v_%7Bi+1%7D))%20-%20f(F%5E%7B-1%7D(v_i))p(F%5E%7B-1%7D(v_i)))"></p>
<p>for some <img src="https://latex.codecogs.com/png.latex?s_i%20%5Cin%20%5Bv_i,%20v_%7Bi+1%7D%5D"></p>
<p>This suggests that if <img src="https://latex.codecogs.com/png.latex?%5Csup_%7B%5B0,%201%5D%7D%20%7CF'%5E%7B-1%7D(u)%7C%20%20=%20%5Csup_%7B%5Ba,%20b%5D%7D%20%5Cfrac%7B1%7D%7Bp(x)%7D%20%3C%20%5Cinfty">, then we can pick up another constant and proceed with our error analysis as before, and thus get a <img src="https://latex.codecogs.com/png.latex?O(%5Cfrac%7B1%7D%7Bn%5E4%7D)"> bound on <img src="https://latex.codecogs.com/png.latex?%5Cmathbb%7BE%7D%5B(I%20-%20S'_n)%5E2%5D">. More careful treatment in something like <span class="citation" data-cites="phillipe1997">Phillipe (1997)</span> can loosen this restriction.</p>
<div class="no-row-height column-margin column-container"></div><p>We can apply this rule to a Beta density <img src="https://latex.codecogs.com/png.latex?p(x)"> of a <img src="https://latex.codecogs.com/png.latex?Beta(2,%203)"> random variable, with our functions from Table&nbsp;1 to estimate <img src="https://latex.codecogs.com/png.latex?%5Cint_0%5E1%20f(x)p(x)%20dx">.</p>
<div class="cell" data-message="false" data-results="asis" data-tbl-format="none" data-layout-nrow="3" data-execution_count="4">
<div id="tbl-error-beta" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-error-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Absolute Error in estimating the integral of <img src="https://latex.codecogs.com/png.latex?f%20=%20%5Cfrac%7B1%7D%7B1%20+%20x%5E2%7D">, <img src="https://latex.codecogs.com/png.latex?g%20=%20e%5Ex%20%5Csin(%5Cfrac%7Bx%7D%7B2%7D)">, <img src="https://latex.codecogs.com/png.latex?h%20=%20x%5E3%20-%20x%20+%20x%5E2"> with respect to the Beta distribution.
</figcaption>
<div aria-describedby="tbl-error-beta-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<style type="text/css">
</style>

<table id="T_cb585" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_cb585_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Integral</th>
<th id="T_cb585_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th id="T_cb585_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">N=10</th>
<th id="T_cb585_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">N=50</th>
<th id="T_cb585_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">N=100</th>
<th id="T_cb585_level0_col5" class="col_heading level0 col5" style="text-align: left;" data-quarto-table-cell-role="th">N=200</th>
<th id="T_cb585_level0_col6" class="col_heading level0 col6" style="text-align: left;" data-quarto-table-cell-role="th">N=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_cb585_row0_col0" class="data row0 col0" style="text-align: left;">0.849556</td>
<td id="T_cb585_row0_col1" class="data row0 col1" style="text-align: left;">Monte Carlo</td>
<td id="T_cb585_row0_col2" class="data row0 col2" style="text-align: left;">0.022431</td>
<td id="T_cb585_row0_col3" class="data row0 col3" style="text-align: left;">0.015612</td>
<td id="T_cb585_row0_col4" class="data row0 col4" style="text-align: left;">0.006972</td>
<td id="T_cb585_row0_col5" class="data row0 col5" style="text-align: left;">0.006267</td>
<td id="T_cb585_row0_col6" class="data row0 col6" style="text-align: left;">0.003704</td>
</tr>
<tr class="even">
<td id="T_cb585_row1_col0" class="data row1 col0" style="text-align: left;">0.849556</td>
<td id="T_cb585_row1_col1" class="data row1 col1" style="text-align: left;">Trapezoid Rule</td>
<td id="T_cb585_row1_col2" class="data row1 col2" style="text-align: left;">0.071244</td>
<td id="T_cb585_row1_col3" class="data row1 col3" style="text-align: left;">0.004386</td>
<td id="T_cb585_row1_col4" class="data row1 col4" style="text-align: left;">0.001175</td>
<td id="T_cb585_row1_col5" class="data row1 col5" style="text-align: left;">0.003429</td>
<td id="T_cb585_row1_col6" class="data row1 col6" style="text-align: left;">0.000172</td>
</tr>
<tr class="odd">
<td id="T_cb585_row2_col0" class="data row2 col0" style="text-align: left;">0.849556</td>
<td id="T_cb585_row2_col1" class="data row2 col1" style="text-align: left;">Simpson's 1/3 Rule</td>
<td id="T_cb585_row2_col2" class="data row2 col2" style="text-align: left;">0.021684</td>
<td id="T_cb585_row2_col3" class="data row2 col3" style="text-align: left;">0.000002</td>
<td id="T_cb585_row2_col4" class="data row2 col4" style="text-align: left;">0.000070</td>
<td id="T_cb585_row2_col5" class="data row2 col5" style="text-align: left;">0.000004</td>
<td id="T_cb585_row2_col6" class="data row2 col6" style="text-align: left;">0.000000</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-row">
<style type="text/css">
</style>

<table id="T_43f94" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_43f94_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Integral</th>
<th id="T_43f94_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th id="T_43f94_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">N=10</th>
<th id="T_43f94_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">N=50</th>
<th id="T_43f94_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">N=100</th>
<th id="T_43f94_level0_col5" class="col_heading level0 col5" style="text-align: left;" data-quarto-table-cell-role="th">N=200</th>
<th id="T_43f94_level0_col6" class="col_heading level0 col6" style="text-align: left;" data-quarto-table-cell-role="th">N=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_43f94_row0_col0" class="data row0 col0" style="text-align: left;">0.331193</td>
<td id="T_43f94_row0_col1" class="data row0 col1" style="text-align: left;">Monte Carlo</td>
<td id="T_43f94_row0_col2" class="data row0 col2" style="text-align: left;">0.047922</td>
<td id="T_43f94_row0_col3" class="data row0 col3" style="text-align: left;">0.032177</td>
<td id="T_43f94_row0_col4" class="data row0 col4" style="text-align: left;">0.012697</td>
<td id="T_43f94_row0_col5" class="data row0 col5" style="text-align: left;">0.005025</td>
<td id="T_43f94_row0_col6" class="data row0 col6" style="text-align: left;">0.003999</td>
</tr>
<tr class="even">
<td id="T_43f94_row1_col0" class="data row1 col0" style="text-align: left;">0.331193</td>
<td id="T_43f94_row1_col1" class="data row1 col1" style="text-align: left;">Trapezoid Rule</td>
<td id="T_43f94_row1_col2" class="data row1 col2" style="text-align: left;">0.000814</td>
<td id="T_43f94_row1_col3" class="data row1 col3" style="text-align: left;">0.001131</td>
<td id="T_43f94_row1_col4" class="data row1 col4" style="text-align: left;">0.005256</td>
<td id="T_43f94_row1_col5" class="data row1 col5" style="text-align: left;">0.001520</td>
<td id="T_43f94_row1_col6" class="data row1 col6" style="text-align: left;">0.000146</td>
</tr>
<tr class="odd">
<td id="T_43f94_row2_col0" class="data row2 col0" style="text-align: left;">0.331193</td>
<td id="T_43f94_row2_col1" class="data row2 col1" style="text-align: left;">Simpson's 1/3 Rule</td>
<td id="T_43f94_row2_col2" class="data row2 col2" style="text-align: left;">0.011204</td>
<td id="T_43f94_row2_col3" class="data row2 col3" style="text-align: left;">0.000972</td>
<td id="T_43f94_row2_col4" class="data row2 col4" style="text-align: left;">0.001880</td>
<td id="T_43f94_row2_col5" class="data row2 col5" style="text-align: left;">0.001769</td>
<td id="T_43f94_row2_col6" class="data row2 col6" style="text-align: left;">0.000013</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-row">
<style type="text/css">
</style>

<table id="T_fb595" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_fb595_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Integral</th>
<th id="T_fb595_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th id="T_fb595_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">N=10</th>
<th id="T_fb595_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">N=50</th>
<th id="T_fb595_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">N=100</th>
<th id="T_fb595_level0_col5" class="col_heading level0 col5" style="text-align: left;" data-quarto-table-cell-role="th">N=200</th>
<th id="T_fb595_level0_col6" class="col_heading level0 col6" style="text-align: left;" data-quarto-table-cell-role="th">N=1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_fb595_row0_col0" class="data row0 col0" style="text-align: left;">-0.085714</td>
<td id="T_fb595_row0_col1" class="data row0 col1" style="text-align: left;">Monte Carlo</td>
<td id="T_fb595_row0_col2" class="data row0 col2" style="text-align: left;">0.061996</td>
<td id="T_fb595_row0_col3" class="data row0 col3" style="text-align: left;">0.014922</td>
<td id="T_fb595_row0_col4" class="data row0 col4" style="text-align: left;">0.000664</td>
<td id="T_fb595_row0_col5" class="data row0 col5" style="text-align: left;">0.006580</td>
<td id="T_fb595_row0_col6" class="data row0 col6" style="text-align: left;">0.001264</td>
</tr>
<tr class="even">
<td id="T_fb595_row1_col0" class="data row1 col0" style="text-align: left;">-0.085714</td>
<td id="T_fb595_row1_col1" class="data row1 col1" style="text-align: left;">Trapezoid Rule</td>
<td id="T_fb595_row1_col2" class="data row1 col2" style="text-align: left;">0.009933</td>
<td id="T_fb595_row1_col3" class="data row1 col3" style="text-align: left;">0.001845</td>
<td id="T_fb595_row1_col4" class="data row1 col4" style="text-align: left;">0.000278</td>
<td id="T_fb595_row1_col5" class="data row1 col5" style="text-align: left;">0.000761</td>
<td id="T_fb595_row1_col6" class="data row1 col6" style="text-align: left;">0.000123</td>
</tr>
<tr class="odd">
<td id="T_fb595_row2_col0" class="data row2 col0" style="text-align: left;">-0.085714</td>
<td id="T_fb595_row2_col1" class="data row2 col1" style="text-align: left;">Simpson's 1/3 Rule</td>
<td id="T_fb595_row2_col2" class="data row2 col2" style="text-align: left;">0.015353</td>
<td id="T_fb595_row2_col3" class="data row2 col3" style="text-align: left;">0.000206</td>
<td id="T_fb595_row2_col4" class="data row2 col4" style="text-align: left;">0.001751</td>
<td id="T_fb595_row2_col5" class="data row2 col5" style="text-align: left;">0.001618</td>
<td id="T_fb595_row2_col6" class="data row2 col6" style="text-align: left;">0.000059</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>As seen in Table&nbsp;2, we can still outperform the naive Monte-Carlo estimator.</p>
<p>If we only have access to an unnormalized density <img src="https://latex.codecogs.com/png.latex?h(x)">, <img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Bh(x)%7D%7BZ%7D%20=%20p(x)">, an application of <a href="https://en.wikipedia.org/wiki/Slutsky%27s_theorem">Slutsky’s Theorem</a> gives us the following estimator (where we simultaneously estimate the normalizing constant <img src="https://latex.codecogs.com/png.latex?Z">):</p>
<p><img src="https://latex.codecogs.com/png.latex?S'_n%20=%20%5Cfrac%7B%5Csum_%7Bi=0%7D%5En%20%5Cfrac%7B1%7D%7B2%7D(z_%7Bi+1%7D%20-%20z_i)%20(f(z_%7Bi+1%7D)h(z_%7Bi+1%7D)%20-%20f(z_i)h(z_i))%7D%7B%5Csum_%7Bi=0%7D%5En%20%5Cfrac%7B1%7D%7B2%7D(z_%7Bi+1%7D%20-%20z_i)%20(h(z_%7Bi+1%7D)%20-%20h(z_i))%7D"></p>
<p>Thus, given a non-zero unnormalized density on <img src="https://latex.codecogs.com/png.latex?%5Ba,%20b%5D"> and access to a sampler, we can estimate an expectation to any smooth function with this estimator <sup>7</sup>.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;In general we can mix and match estimators for the normalizing constant in the denominator. These estimators will be consistent, but in general will not be unbiased.</p></div></div></section>
<section id="other" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="other">Other</h2>
<p>This type of estimator seems to have been originally derived from <span class="citation" data-cites="yakowitz1978">Yakowitz and Szidarovszky (1978)</span> for the unit interval. <span class="citation" data-cites="phillipe1997">Phillipe (1997)</span> and related works extend the Riemann sum estimator to other distributions.</p>


<div class="no-row-height column-margin column-container"><div id="ref-yakowitz1978" class="csl-entry">
Yakowitz, Krimmel, S., and F. Szidarovszky. 1978. <span>“Weighted Monte Carlo Integration.”</span> <em>SIAM Journal on Numerical Analysis</em> 15 (6): 1289–1300.
</div><div id="ref-phillipe1997" class="csl-entry">
Phillipe, Anne. 1997. <span>“Importance Sampling and Riemann Sums.”</span> <em>Publications IRMA Université de Lille</em> 43 (IV).
</div></div>
</section>


 ]]></description>
  <category>monte-carlo</category>
  <category>quadrature</category>
  <guid>https://www.shoresofinfinity.net/posts/trapezoid_mc/quad_mc.html</guid>
  <pubDate>Fri, 19 Sep 2025 07:00:00 GMT</pubDate>
</item>
</channel>
</rss>
